<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>رسائل صباحية لمُنار — هدية حب</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet" />
<style>
  :root{
    --bg1: #fff6fb;
    --bg2: #fff0f6;
    --accent1: #b3395a;
    --accent2: #ff6fa3;
    --accent3: #a33258;
    --text: #633750;
    --muted: #9b6a78;
    --glass: rgba(255, 244, 251, 0.9);
  }

  /* PAGE */
  html,body{height:100%;}
  body{
    margin:0;padding:0;
    font-family:'Tajawal',sans-serif;
    background: radial-gradient(1200px 600px at 10% 10%, #fff2f8 0%, rgba(255,238,244,0.6) 30%, var(--bg2) 100%), linear-gradient(180deg, var(--bg1), var(--bg2));
    color:var(--text);
    display:flex;
    justify-content:center;
    align-items:center;
    direction:rtl;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow:hidden;
  }

  /* MAIN CARD */
  .container {
    width:92%;
    max-width:820px;
    background: linear-gradient(180deg, rgba(255,250,253,0.95), rgba(255,245,250,0.92));
    border-radius:24px;
    padding:28px;
    box-shadow: 0 30px 80px rgba(179,57,90,0.12);
    position:relative;
    overflow:visible;
  }

  header {
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    margin-bottom:6px;
  }
  .title {
    display:flex;
    align-items:center;
    gap:12px;
  }
  .logo {
    width:58px;height:58px;border-radius:14px;
    background:linear-gradient(135deg,var(--accent2),var(--accent3));
    display:flex;align-items:center;justify-content:center;color:white;font-weight:900;font-size:20px;box-shadow:0 10px 30px rgba(163,58,90,0.08);
  }
  h1{
    margin:0;
    font-size:22px;
    color:var(--accent1);
    letter-spacing:0.6px;
  }
  .sub {
    color:var(--muted);
    font-size:13px;
    margin-top:4px;
  }

  /* overlay modal (identity check) */
  .overlay {
    position:fixed;inset:0;
    display:flex;align-items:center;justify-content:center;
    background:linear-gradient(180deg, rgba(15,8,12,0.32), rgba(15,8,12,0.44));
    z-index:1200;
    padding:20px;
  }
  .modal {
    width:100%; max-width:640px; background:var(--glass); border-radius:16px; padding:20px 22px; box-shadow:0 30px 80px rgba(0,0,0,0.25); text-align:center;
  }
  .modal h2 { margin:0; color:var(--accent1); font-size:20px; font-weight:800; }
  .modal p { color:var(--muted); margin:10px 0 12px; font-size:15px; }
  .dateRow { display:flex; gap:10px; justify-content:center; align-items:center; flex-wrap:wrap; margin-top:10px; }
  input[type="date"]{ padding:10px 12px; border-radius:10px; border:1px solid rgba(99,55,80,0.07); font-size:15px; background:white; }
  .modal .smallNote{ font-size:13px; color:#8a5970; margin-top:8px; }

  /* Buttons */
  .btn {
    padding:10px 18px; border-radius:14px; border:none; cursor:pointer;
    background:linear-gradient(135deg,var(--accent2),var(--accent3)); color:white; font-weight:700; font-size:15px;
    box-shadow:0 8px 26px rgba(179,57,90,0.14); margin:6px;
  }
  .btn.ghost{ background:transparent; color:var(--accent1); border:2px solid rgba(179,57,90,0.12); box-shadow:none; }

  /* Main interactive area */
  .main {
    display:grid; grid-template-columns: 1fr 320px; gap:18px; align-items:start;
  }
  @media (max-width:920px){ .main{ grid-template-columns: 1fr; } }

  /* Left panel: messages & controls */
  .left {
    min-height:320px;
  }
  .lead { color:var(--muted); margin:8px 0 14px; font-size:15px; }

  .controls { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
  .choiceRow { margin-top:8px; display:flex; gap:8px; justify-content:center; }

  /* message box */
  #messageBox {
    background: linear-gradient(180deg,#fff9fc,#fff4fb);
    border-radius:16px; padding:18px; font-size:18px; line-height:1.9; color:var(--text);
    box-shadow: inset 0 6px 18px rgba(255,205,225,0.45); min-height:210px; text-align:justify; white-space:pre-line;
    transition: transform 260ms ease, opacity 260ms ease;
    opacity:0; transform:translateY(6px);
  }
  #messageBox.visible { opacity:1; transform:none; }

  /* right panel: love-journal + extras */
  .right {
    background: linear-gradient(180deg,#fff0f6, #fff8fb);
    border-radius:14px; padding:14px; box-shadow:0 10px 30px rgba(179,57,90,0.06);
    display:flex; flex-direction:column; gap:10px; align-items:stretch;
  }
  .journal { font-size:14px; color:var(--muted); min-height:120px; overflow:auto; padding:8px; border-radius:10px; background:white; border:1px solid rgba(99,55,80,0.03); }
  .meta { font-size:13px; color:#8a5970; text-align:center; }

  /* little romantic badges */
  .badge { display:inline-block; padding:6px 10px; border-radius:20px; background:rgba(179,57,90,0.08); color:var(--accent1); font-weight:700; font-size:13px; }

  /* heart particles */
  .particle {
    position:fixed; pointer-events:none; z-index:10;
    transform-origin:center;
    opacity:0.85;
    filter: blur(0.2px);
  }

  /* typing sparkle */
  .sparkle { display:inline-block; width:8px; height:8px; border-radius:50%; background:rgba(255,122,180,0.95); box-shadow:0 0 14px rgba(255,122,180,0.55); vertical-align:middle; margin-left:8px; animation:twinkle 1.6s infinite; }
  @keyframes twinkle { 0%{opacity:0.2}50%{opacity:1}100%{opacity:0.2} }

  /* small nice transitions */
  .fadeIn { animation: fadeUp 420ms ease forwards; opacity:0; }
  @keyframes fadeUp { from{ opacity:0; transform:translateY(6px);} to{opacity:1; transform:none;} }

  footer { margin-top:14px; display:flex; justify-content:space-between; align-items:center; gap:12px; }
  footer .note { color:var(--muted); font-size:13px; }

  /* responsive tweaks */
  @media (max-width:520px){
    h1{ font-size:18px; }
    .main{ gap:12px; }
    .right{ order:2; }
  }
</style>
</head>
<body>

  <!-- heart particles (decorative) -->
  <div id="particlesRoot" aria-hidden="true"></div>

  <!-- overlay modal -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal" role="document">
      <h2 id="modalTitle">مرحبًا بكِ يا جميلة ✨</h2>
      <p>قبل ما نبدأ — بس عشان نتأكد إن الصفحة دي مخصوصة للأميرة <strong>منار</strong>، ممكن تقولي إذا كنتِ منار؟</p>

      <div id="step1" aria-hidden="false">
        <div style="display:flex; justify-content:center; gap:12px; margin-top:8px;">
          <button id="imManarBtn" class="btn">أيوة، أنا منار 💖</button>
          <button id="notManarBtn" class="btn ghost">لا، مش منار</button>
        </div>
        <p class="smallNote">لو ضغطتي "أيوة" هنسألك تاريخ ميلاد زوجِك عشان نأكد وندخلك بطريقة رومانسية ♥️</p>
      </div>

      <div id="step2" style="display:none;" aria-hidden="true">
        <p>دخل/ي تاريخ ميلاد زوجِك باستخدام التقويم (اختاري اليوم/الشهر/السنة):</p>
        <div class="dateRow">
          <input id="dobInput" type="date" aria-label="تاريخ ميلاد زوجك" />
          <button id="checkDobBtn" class="btn">تأكيد التاريخ</button>
        </div>
        <div id="dobHint" class="smallNote">مثال: لو تاريخ الميلاد 24/11/1996 اختاري 24 نوفمبر 1996 في التقويم.</div>
        <div id="dobError" class="error" style="display:none;" role="alert"></div>
      </div>

      <div id="step3" style="display:none;" aria-hidden="true">
        <div id="successBlock" class="welcomeBubble" style="display:none;">
          <!-- content injected -->
        </div>
        <div id="failBlock" style="display:none;">
          <p class="error">معلش... الموقع ده مخصوص بس للأميرة <strong>منار نسيم الحسنيين</strong>.</p>
          <p class="smallNote">لو ده غلط، ممكن ترجعي وتحاولي التاريخ تاني.</p>
          <div style="margin-top:10px;">
            <button id="tryAgainBtn" class="btn ghost">حاول تاني</button>
            <button id="exitBtn" class="btn">خروج</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container" role="main" aria-label="رسائل صباحية لمنار">
    <header>
      <div class="title">
        <div class="logo">نُن</div>
        <div>
          <h1>رسائل صباحية لمُنار</h1>
          <div class="sub">هدية صغيرة من القلب — افتحي وعيشي اللحظة 💕</div>
        </div>
      </div>
      <div class="meta">
        <span class="badge">مفاجآت رومانسية</span>
      </div>
    </header>

    <div class="main">
      <div class="left">
        <p id="greeting" class="lead" aria-live="polite"></p>

        <div class="controls" id="controlsTop">
          <div id="buttonsDiv">
            <button id="yesBtn" class="btn">أيوة طبعًا 💖</button>
            <button id="waitBtn" class="btn ghost">استني شوية ⏳</button>
          </div>
        </div>

        <div id="choiceDiv" style="display:none; margin-top:8px;" class="choiceRow" aria-hidden="true">
          <p style="margin:0; color:var(--muted); font-size:14px;">اختاري نوع الرسالة اللي تحبي تشوفيها:</p>
          <div style="display:flex; gap:8px;">
            <button id="shortMsgBtn" class="btn">رسالة صباحية يانونة</button>
            <button id="longMsgBtn" class="btn ghost">جزء من جواب من زوجك الحبيب</button>
          </div>
        </div>

        <div id="messageBox" aria-live="polite" aria-atomic="true" role="status"></div>

        <div style="margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <button id="anotherBtn" class="btn ghost" style="display:none;">عايزة رسالة تانية</button>
          <button id="saveBtn" class="btn" style="display:none;">حفظ في دفتر الحب</button>
        </div>
      </div>

      <aside class="right" aria-hidden="false">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div style="font-weight:800; color:var(--accent1)">دفتر الحب</div>
          <div style="font-size:13px; color:var(--muted)">يخزن الرسائل اللي بتحبيها</div>
        </div>
        <div id="journal" class="journal" aria-live="polite"></div>
        <div class="meta">اضغطي <strong>حفظ</strong> لو عايزة تخزني الرسالة دي في دفتر الحب ❤️</div>
      </aside>
    </div>

    <footer>
      <div class="note">مفعّل: لمسات رومانسية، قلوب متحركة، وحركات لطيفة</div>
      <div style="font-size:13px; color:var(--muted)">مع حب من صانع الرسائل ✨</div>
    </footer>
  </div>

<script>
/* ============================
   الرسائل الأصلية (كما أرسلتها) — لم أحذف أو أغيّر فيها مطلقًا
   ============================ */

const shortMessages = [
  `صحيت يا نونه؟ النهاردة يوم جديد وحلو وفرصة عشان تحققي كل اللي نفسك فيه.`,
  `يا نونه يا حبيبتي، فاكرة دايمًا إنك مش لوحدك، أنا جنبك دايمًا.`,
  `صباحك ورد يا نونه، خلي ابتسامتك تفتحلك أبواب الخير كلها.`,
  `يا نونه يا بنتي، دايمًا افتكري إنك أجمل حاجة في حياتي.`,
  `النهاردة يوم جديد، يا نونه، خدتي نفسك وعيشي اللحظة.`,
  `نونه يا أختي وصحبتي، كل يوم معاك أجمل من اللي قبله.`,
  `يا نونه يا روحي، لو واجهتي حاجة صعبة، افتكري دايمًا إنك قوية قد الدنيا.`,
  `صباح الورد يا نونه، يا أجمل نسمه في حياتي.`,
  `نونه يا أمي، في حضنك بحس بالأمان والدفا.`,
  `يا نونه يا قلبي، افتكري دايمًا إن ضحكتك أجمل حاجة في الدنيا.`,
  `نونه، النهاردة فرصة جديدة تبدأي بيها أحلامك من أول وجديد.`,
  `يا نونه، بحب أشوفك سعيدة، عشانك الفرحة في قلبي.`,
  `صباح الخير يا نونه، يا أحلى ملاك في الدنيا.`,
  `نونه، حتى لو الدنيا صعبة، أنا هنا دايمًا سندك.`,
  `يا نونه، خلي عندك ثقة إنك تقدري تغيري حياتي للأحسن.`,
  `نونه يا صحبتي، كل يوم بحمد ربنا إنك في حياتي.`,
  `صباح النور يا نونه، يا وردة بتتفتح كل صباح.`,
  `نونه يا حبيبتي، افتكري دايمًا إنك ليكي مكانة خاصة في قلبي.`,
  `يا نونه يا بنتي، إنتي مش بس حبيبتي، إنتي كل حياتي.`,
  `نونه، خلي ابتسامتك نور يملأ الدنيا.`,
  `يا نونه، مهما حصل، أنا معاك على طول.`,
  `نونه يا أختي، عايز أشوفك دايمًا بخير وفرحانة.`,
  `صباح الفل يا نونه، يا أجمل هدية ربنا ادهالي.`,
  `نونه يا كل مالي في الدنيا، أنا مبسوط دايمًا بقربك.`,
  `يا نونه، افتكري دايمًا إنك قوية وجميلة.`,
  `نونه، صباحك سعيد ومليان حب وفرحة.`,
  `يا نونه، مهما تبعدي، قلبي معاك.`,
  `نونه يا وردة، خلي يومك يبتدي بأحلى حاجة.`,
  `صباح الخير يا نونه، أنا دايمًا بفكر فيكي.`,
  `نونه، عايز أقولك إنك نعمة من ربنا في حياتي.`,
  `يا نونه يا غالية، خلي كل يوم يبدأ بحلم جديد.`,
  `صباح الفل يا أجمل نونه، يومك يبدأ بابتسامة جميلة زيك بالظبط.`,
  `نونه، لما بتصحى وأنتِ مرتاحة، الدنيا كلها بتضحكلك.`,
  `يا نونه، كل كلمة حب في قلبي ليكي مش بتكفي توصفك.`,
  `نونه يا بنتي، لما بتتكلمي بصوتك الحلو بحس الدنيا كلها بأمان.`,
  `صباح الخير يا نور عيني، يا أجمل ملاك في حياتي.`,
  `يا نونه، دايمًا خليكي قدوة لنفسك ولكل الناس اللي حواليكي.`,
  `نونه، مهما تعبتي، ربنا معاك وهيعوضك دايمًا بالخير.`,
  `نونه يا أمي، بحس بالدفا والأمان لما بشوف ضحكتك.`,
  `يا نونه، الدنيا محتاجة منك ضحكة تملى قلبها فرح.`,
  `نونه، يا وردة جميلة، دايمًا خليكِ مشرقة زي الشمس.`,
  `صباح الخير يا حبيبتي، يا نونه اللي قلبي بيفرح بيها كل يوم.`,
  `نونه، حتى لو الدنيا كانت غريبة، أنا دايمًا جنبك.`,
  `يا نونه، خلي قلبك دايمًا مليان أمل وحب يا اجمل بنوتة في الدنيا.`,
  `نونه، انتِ مش بس ملاكي، انتِ كل حكاياتي الحلوة.`,
  `صباح الفل يا نونه، يا نور الدنيا اللي ما بينطفيش.`,
  `نونه يا صحبتي، معاك الحياة أجمل وأحلى بكتير.`,
  `يا نونه، خلي طموحاتك كبيرة وقوية زي قلبك.`,
  `نونه، عايز أقولك إنك أجمل قصة في حياتي.`,
  `نونه يا بنتي، لما بتضحكي بحس الدنيا ملكنا.`,
  `يا نونه، خليك دايمًا مميزة بطريقتك الجميلة.`,
  `نونه، مهما حصل، أنا جنبك على طول.`,
  `صباح الورد يا نونه، يا ملاك بيغمر الدنيا نور.`,
  `نونه، قلبي بيغني كل يوم لما بشوفك بخير.`,
  `يا نونه، الدنيا بتتزين بضحكتك اللي ما ليها مثيل.`,
  `نونه يا أمي، حضنك هو الدفا والأمان في الدنيا.`,
  `نونه، خلي يومك يبدأ بأحلى أمنية.`,
  `صباح الخير يا نونه، يا وردة بتنور كل مكان.`,
  `يا نونه، مهما تبعدي، قلبي معاك في كل لحظة.`,
  `نونه، انتِ مش بس حبيبتي، انتِ أختي وصحبتي.`,
  `نونه، خلي أحلامك كبيرة عشان تستاهلي كل حاجة حلوة.`,
  `صباح الفل يا نونه، يا أجمل هدية من ربنا.`,
  `نونه، لما بتكوني بخير الدنيا بتضحكلك.`,
  `يا نونه، خلي كل يوم يبتدي بحب جديد.`,
  `نونه، بحب أقولك دايمًا إنتِ سر سعادتي.`,
  `نونه يا بنتي، خليكي قوية زي قلبك الحلو.`,
  `يا نونه، ضحكتك بتنور أيامي.`,
  `نونه، دايمًا معاك في كل خطوة في حياتك.`,
  `صباح الخير يا نونه، يا أجمل ملاك في الدنيا.`,
  `نونه، مهما تغيرت الظروف، أنا معاك على طول.`,
  `يا نونه، خلي قلبك مليان فرح وأمل.`,
  `نونه، إنتِ أغلى من كل حاجة في الدنيا.`,
  `صباح الورد يا نونه، يا أجمل زهرة في بستان حياتي.`,
  `نونه، خلي كل لحظة تمر عليك تكون مليانة حب وسعادة.`,
  `يا نونه، دايمًا خليكي قوية ومتألقة زي النجوم.`,
  `نونه، بحب أشوفك دايمًا ضحكتك منورة الدنيا.`,
  `نونه يا أمي، حضنك هو الأمان والراحة اللي بدور عليها.`,
  `نونه، عايز أقولك إنتِ السبب في فرحتي كل يوم.`,
  `صباح الخير يا نونه، يا أجمل هدية من ربنا ليّا.`,
  `يا نونه، خلي طموحك كبير وكل يوم يكون بداية جديدة.`,
  `نونه، مهما كانت الدنيا صعبة، ربنا معاك ومساندك.`,
  `نونه يا بنتي، ضحكتك بتنسي أي تعب.`,
  `نونه، خليكي دايمًا مشعة زي الشمس في السماء.`,
  `صباح الفل يا نونه، يا أغلى من نور عيني.`,
  `نونه، عايز أقولك إنك سر سعادتي وراحتي.`,
  `يا نونه، خلي قلبك دايمًا مليان حب وأمل.`,
  `نونه، انتِ أجمل حاجة حصلت في حياتي.`,
  `نونه يا صحبتي، دايمًا بحمد ربنا على وجودك في حياتي.`,
  `نونه، خلي ابتسامتك نورت أيامي المظلمة.`,
  `صباح الخير يا نونه، يا أجمل ملاك.`,
  `نونه، مهما حصل، أنا دايمًا جنبك.`,
  `يا نونه، خلي يومك سعيد ومليان نجاح.`,
  `نونه، بحب أقولك دايمًا إنتِ أحلى هدية من ربنا.`,
  `نونه يا وردة، خليكي دايمًا متألقة ومتوهجة في كل وقت.`
];

const longMessages = [
`أكتب إليكِ الآن يا منار، وفي قلبي من الشوق ما لو نطقت به الحروف لاحترقت،
وفي صدري من الحب ما يعجز عنه البوح،
لكنّني أُجاهد اللغة، وأُعاتب الحبر، علّه يُنصفكِ ولو بالقليل من كثيرٍ يستقرّ داخلي.

أكتب إليكِ كما تكتب السماء سطورها بالنجوم، وكما ترسل الشمس أشعتها إلى الأرض دون أن تطلب مقابلًا.
أكتب إليكِ لأنكِ لستِ فقط جزءًا من أيامي، بل أنتِ الزمان الذي أعيش فيه، والمسافة التي أقطعها لأصل إلى ذاتي.
أنتِ الهواء حين يضيق صدري، والماء حين يجف قلبي، والدفء حين تتكاثر برودة الأيام.

يا نونه الحبيبة،
لو كانت القلوب تُرى، لرأيتِ اسمكِ محفورًا في قلبي كما تُنقش الآيات على الحجر،
ولو سُمح للكلمات أن تبني وطنًا، لبنيت لكِ من مفردات عشقي قصرًا لا يتهدّم.

لقد جمعتُ لكِ الذهب، لا لثقله، بل لقيمته التي تليق بقلبٍ مثلكِ،
وأنا لا أقدّم لكِ مجرّد هدية، بل أقدّمكِ للعالم عروسًا لقلبٍ لم يعرف حبًّا غيرك.

واعلمي، يا كلّ أيامي، أنّكِ لستِ عبئًا ولا همًا،
بل أنتِ الحياة حين تبتسم، والحظ حين يُنصف، والقدر حين يُحسن الاختيار.

خلافي معكِ لا يُنقص من حبّي، بل يُثبّته،
فحتى الأمواج تصطدم بالصخر، لكنها لا ترحل،
بل تعود كل مرّة، بشغفٍ أكبر، لتُقبّله من جديد.`,

`منار نونه عمري، يا حلم عمري،  
حين أراكِ تشرقين في صباحي، أشعر أن الكون قد منحني أجمل هدية،  
أنتِ الحنان الذي يملأ قلبي، والصوت الذي يغني لي ألحان الأمان.  

نونه، يا وردتي التي تذبل حين تغيبين، وتتفتح بأشعة حبك،  
كل يوم معك هو بداية جديدة لحياة لا تنتهي من العشق،  
وعندما تلمسين يدي، أشعر أن روحي تُشفى من كل ألم،  
وأحلامي تزهر في بستان حبك الكبير.`,

`يا نونه، يا منار قلبي وروحي،  
كل لحظة تمرّ بدون صوتك كأنها شتاء بلا دفء،  
أنتِ الحكاية التي تعيشها أيامي،  
والنور الذي لا يخبو في عتمة الليالي.  

أحبك فوق كل وصف،  
وأهديك قلبي مكتوبًا بأحرف الشوق والوله،  
فيا منارة حياتي،  
دعيني أظل أكتب لكِ قصائد العشق بلا نهاية.`,

`نونه الحبيبة، يا قمر عيوني،  
حين يغيب النهار ويحل الليل،  
أتذكركِ وأكتب اسمكِ على جدران قلبي،  
فأنتِ القصة الأجمل التي عرفت كيف تروى في حياتي.  

منار، أنتِ النور الذي يضيء دربي،  
والصوت الذي يلهمني ألحان الفرح،  
كل همسة منك تزرع في قلبي زهرة أمل،  
وأنتِ الأمان الذي لا يزول مهما طال الزمن.`, 

`يا نونه، يا ملاكي الحنون،  
كم تمنيت لو كنت كلمات لأخبرك كم أحبك،  
لكنكِ أكبر من كل الكلمات، وأعمق من كل المشاعر،  
فحبكِ في قلبي لا يموت، ولا يعرف النهاية.  

منار، أنتِ الحلم الذي تحقق،  
والحب الذي لا يذبل،  
ومعكِ فقط عرفت معنى السعادة.`, 

`نونه يا عمري، يا زهرة قلبي،  
كل صباح يبتسم لأنك فيه،  
وأنا أبدأ يومي بدعاء أن يحفظك الله لي،  
ويملأ أيامك حبًا وفرحًا لا ينتهي.`, 

`منار الغالية، يا ملاك روحي،  
كل كلمة حب أرسلها لكِ،  
هي نبضات قلبي التي تنطق باسمك،  
وكل لحظة تمر لا أتخيل الحياة بدونك.`, 

`نونه الحبيبة، يا بسمة حياتي،  
لو استطعت أن أزرع الدنيا ورودًا،  
لزرعتها فقط لتكون طريقك مليء بالجمال والفرح.`, 

`يا منار، يا ملكة قلبي،  
أعدك أن أكون دائمًا بجانبك،  
أمسد يدك وقت الضعف، وأشاركك الفرح والسرور.`, 

`نونه، يا أنشودة عمري،  
كل يوم أعيشه معك هو أغنية حب لا تنتهي،  
وأنتِ لحنها الجميل الذي يسكن قلبي.`
];

const waitMessages = [
  "براحتك يا نونه، خدي وقتك وأنا دايمًا مستنيك.",
  "مش مستعجل يا نونه، أنا هنا عشانك في أي وقت.",
  "خدي راحتك، ونفسي أشوفك سعيدة دايمًا يا نونه.",
  "لما تكوني جاهزة، أنا هنا وقلبي معاك.",
  "استني على مهلك، يا نونه حياتي، وأنا جنبك."
];

/* ============================
   إضافات رومانسية (prefix/suffix) — تظهر مع كل رسالة عند العرض
   — لا تُغيّر الرسائل الأصلية أبداً
   ============================ */

const romanticPrefixes = [
  "يا أميرة قلبي، أفتح عيونك للحظة واسمحي لقلبي يكلمك:",
  "نونه الحبيبة، قبل ما تقرأي الرسالة، خدي نفس عميق وابتسمي:",
  "يا ضي عيوني، هنا كلمة صغيرة من قلبي ليكي:",
  "حبيبتي، خلي اللي جاي يلمس قلبك بلطف:",
  "إلى أغلى الناس، هذي الكلمات من قلبي لكِ:"
];

const romanticSuffixes = [
  " — ومع كل حرف، تذكري إني هنا دايمًا، أحبّك فوق كل وصف.",
  " 💕 أبقى أحبك وأدلعك، وإيدك في إيدي لحد آخر يوم.",
  " — قلبي معاكي، وباقي أهلًا في حضرتك دايمًا.",
  " ✨ كل رسالة مني ليكي نغمة حب ما بتخلص.",
  " 🌹 لو قلبي يِغنّي كان غنّى باسمك ليل ونهار."
];

/* ============================
   عناصر DOM ومساعدات
   ============================ */

const yesBtn = document.getElementById('yesBtn');
const waitBtn = document.getElementById('waitBtn');
const buttonsDiv = document.getElementById('buttonsDiv');
const choiceDiv = document.getElementById('choiceDiv');
const shortMsgBtn = document.getElementById('shortMsgBtn');
const longMsgBtn = document.getElementById('longMsgBtn');
const messageBox = document.getElementById('messageBox');
const anotherBtn = document.getElementById('anotherBtn');
const saveBtn = document.getElementById('saveBtn');
const journal = document.getElementById('journal');
const greeting = document.getElementById('greeting');

const overlay = document.getElementById('overlay');
const imManarBtn = document.getElementById('imManarBtn');
const notManarBtn = document.getElementById('notManarBtn');
const step1 = document.getElementById('step1');
const step2 = document.getElementById('step2');
const step3 = document.getElementById('step3');
const dobInput = document.getElementById('dobInput');
const checkDobBtn = document.getElementById('checkDobBtn');
const dobError = document.getElementById('dobError');
const successBlock = document.getElementById('successBlock');
const failBlock = document.getElementById('failBlock');
const tryAgainBtn = document.getElementById('tryAgainBtn');
const exitBtn = document.getElementById('exitBtn');

/* ============================
   ترحيب حسب الوقت
   ============================ */
function getGreetingText() {
  const now = new Date();
  const hour = now.getHours();
  if (hour >= 5 && hour < 12) return "صباح الخير يا نونه صحيتي يا قلبي؟";
  else if (hour >= 12 && hour < 17) return "ظهر الخير يا نونه يا أجمل ملاك";
  else if (hour >= 17 && hour < 20) return "مساء الخير يا نونه يا ضي عيوني";
  else return "تصبح على خير يا نونه يا وردة قلبي";
}
greeting.textContent = getGreetingText();

/* ============================
   particles (قلوب متحركة) — لمسة رومانسية
   ============================ */
function makeParticle(x, y, size, delay, opacity) {
  const root = document.getElementById('particlesRoot') || document.body;
  const el = document.createElement('div');
  el.className = 'particle';
  el.style.left = x + 'px';
  el.style.top = y + 'px';
  el.style.fontSize = size + 'px';
  el.style.opacity = opacity || 0.85;
  el.style.transform = `translateY(0) scale(1)`;
  el.innerHTML = '❤️';
  el.style.transition = `transform 6s cubic-bezier(.2,.9,.3,1) ${delay}s, opacity 6s linear ${delay}s`;
  document.body.appendChild(el);
  // start
  setTimeout(() => { el.style.transform = `translateY(-120vh) scale(${1.6})`; el.style.opacity = '0'; }, 50);
  setTimeout(()=> el.remove(), (delay + 6) * 1000 + 200);
}
/* spawn random hearts periodically */
setInterval(()=> {
  const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
  const x = Math.random() * vw * 0.9 + 20;
  makeParticle(x, window.innerHeight + 40, 18 + Math.random()*18, 0.1 + Math.random()*1.2, 0.7 + Math.random()*0.25);
}, 700);

/* ============================
   overlay (identity check) logic — نفس المنطق الأصلي مع لمسة ترحيب مطوّل
   ============================ */
window.addEventListener('load', ()=> {
  const today = new Date().toISOString().split('T')[0];
  dobInput.max = today;
  imManarBtn.focus();
});

imManarBtn.addEventListener('click', () => {
  step1.style.display = 'none';
  step2.style.display = 'block';
  step2.setAttribute('aria-hidden','false');
  dobInput.focus();
});

notManarBtn.addEventListener('click', () => {
  step1.style.display = 'none';
  step3.style.display = 'block';
  document.getElementById('failBlock').style.display = 'block';
  document.getElementById('failBlock').querySelector('.error').textContent = "معلش... الموقع ده مخصوص بس للأميرة منار نسيم الحسنيين.";
});

function formatDateToDDMMYYYY(yyyy_mm_dd) {
  if(!yyyy_mm_dd) return '';
  const parts = yyyy_mm_dd.split('-');
  if(parts.length !== 3) return yyyy_mm_dd;
  return `${('0'+parts[2]).slice(-2)}/${('0'+parts[1]).slice(-2)}/${parts[0]}`;
}

checkDobBtn.addEventListener('click', () => {
  dobError.style.display = 'none';
  const val = dobInput.value;
  if(!val) {
    dobError.style.display = 'block';
    dobError.textContent = "لو سمحتي اختاري التاريخ من التقويم.";
    return;
  }
  const expected = "1996-11-24";
  if(val === expected) {
    step2.style.display = 'none';
    step3.style.display = 'block';
    successBlock.style.display = 'block';
    // a gentle romantic reveal
    const formatted = formatDateToDDMMYYYY(val);
    const romanticLines = [
      `يا منار... مساء الورد والسكر 🌹`,
      `النهاردة قلبي بيغني ليكي لأنك دخلتي هنا بـ تاريخ مهم وحابب أرحب بيكي بأحلى كلام.` ,
      `تاريخ ميلاد زوجك: ${formatted} — كل تاريخ ليه حكاية، وحكايتكم أجمل حكاية بحسها.`,
      `ادخلي يا نونه.. الباب مفتوح وقلبي معاكي عشان نكمل سوا كلام حب يدوب في القلب...`
    ];
    successBlock.innerHTML = "";
    romanticLines.forEach((ln,i)=> {
      const p = document.createElement('p');
      p.textContent = ln;
      p.style.margin = '8px 0';
      p.style.opacity = '0';
      successBlock.appendChild(p);
      setTimeout(()=> { p.style.transition = 'opacity 420ms'; p.style.opacity = '1'; }, 120*i);
    });
    const cont = document.createElement('div');
    cont.style.marginTop = '12px';
    cont.innerHTML = `<button id="continueBtn" class="btn">خليّنا نكمل يا نونه 💖</button>`;
    successBlock.appendChild(cont);
    setTimeout(()=> {
      const btn = document.getElementById('continueBtn');
      btn.focus();
      btn.addEventListener('click', ()=> closeOverlayAndReveal());
    }, 900);
  } else {
    step2.style.display = 'none';
    step3.style.display = 'block';
    document.getElementById('failBlock').style.display = 'block';
  }
});

tryAgainBtn.addEventListener('click', ()=> {
  document.getElementById('failBlock').style.display = 'none';
  step3.style.display = 'none';
  step2.style.display = 'block';
  dobInput.value = '';
  dobInput.focus();
});

exitBtn.addEventListener('click', ()=> {
  closeOverlayAndReveal(true);
});

function closeOverlayAndReveal(unauthorized=false){
  overlay.style.display = 'none';
  if(!unauthorized) {
    messageBox.classList.remove('visible');
    messageBox.style.opacity = '0';
    messageBox.textContent = "أهلاً يا منار ♥️ — متشوقين نبيّنلك اليوم كلام حنين من بابي جمعة...";
    messageBox.classList.add('visible');
    // enable controls (they are already enabled in markup)
    setTimeout(()=> {
      messageBox.classList.remove('visible');
      document.getElementById('buttonsDiv').style.display = 'block';
      choiceDiv.style.display = 'none';
    }, 1300);
  } else {
    messageBox.classList.add('visible');
    messageBox.innerHTML = `<strong>معلش...</strong> الصفحة دي مخصوصة للأميرة منار نسيم الحسنيين. لو إنتي منار حاولي تدخل التاريخ الصح.`;
    buttonsDiv.style.display = 'none';
    choiceDiv.style.display = 'none';
  }
}

/* ============================
   عرض الرسائل مع اضافة دلع ورومانسية (دون تغيير المصفوفات الأصلية)
   الطريقة: نختار prefix و suffix عشوائيين ونضمهم مع الرسالة الأصلية عند العرض
   ============================ */

function randomFrom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

function buildRomanticText(original){
  // نضيف prefix قبل الرسالة و suffix بعدها، مع لمسة دلع إضافية بين السطور
  const prefix = randomFrom(romanticPrefixes);
  const suffix = randomFrom(romanticSuffixes);

  // small playful teasing line sometimes
  const teasers = [
    "يا قلبي ما تطوليش لوحدك، خليني أدلعك بكلمة.",
    "خليكي معايا ثواني وخليني أحمّلك شوية حب.",
    "لو الدنيا بتبقى تقيلة، خلي الرسالة دي تخفف عنك.",
    "بس خلي الضحكة متبقاش بعيدة، خليك نونه جميلة."
  ];
  const tease = Math.random() < 0.45 ? ("\n\n" + randomFrom(teasers)) : "";

  return `${prefix}\n\n${original}${tease}\n\n${suffix}`;
}

/* show short message */
function showRandomShortMessage(){
  const idx = Math.floor(Math.random()*shortMessages.length);
  const original = shortMessages[idx];
  const finalText = buildRomanticText(original);
  displayMessage(finalText);
}

/* show long message (عرض مع لمسات إضافية لكن بدون حذف أو تغيير طويل) */
function showRandomLongMessage(){
  const idx = Math.floor(Math.random()*longMessages.length);
  const original = longMessages[idx];
  // for long messages نضيف ختم حنون في النهاية
  const hugLines = [
    "\n\nكل كلمة مكتوبة من قلبي وتقولك: تعيشي وتحلى دنيايا بحبك.",
    "\n\nقبل ما أقفل، بحطلك حضن صغير في آخر الرسالة، تعالي حطي راسك فيه.",
    "\n\nلو سمعتي قلبي هتلاقيه بينبض باسمك، خدي مني سلام وحُب دائم."
  ];
  const finalText = buildRomanticText(original + randomFrom(hugLines));
  displayMessage(finalText);
}

/* show wait message */
function showRandomWaitMessage(){
  const idx = Math.floor(Math.random()*waitMessages.length);
  const original = waitMessages[idx];
  const finalText = buildRomanticText(original);
  displayMessage(finalText);
}

/* display message with gentle animation, enable save/another */
function displayMessage(text){
  // animate
  messageBox.classList.remove('visible');
  setTimeout(()=> {
    messageBox.textContent = ""; // clear
    // simple "fade in line by line" to feel poetic
    const lines = text.split('\n');
    let i=0;
    function reveal(){
      if(i>=lines.length){
        messageBox.classList.add('visible');
        anotherBtn.style.display = 'inline-block';
        saveBtn.style.display = 'inline-block';
        anotherBtn.classList.remove('ghost'); // style preference
        return;
      }
      const span = document.createElement('div');
      span.style.opacity = '0';
      span.style.marginBottom = '6px';
      span.textContent = lines[i];
      messageBox.appendChild(span);
      setTimeout(()=> { span.style.transition='opacity 360ms'; span.style.opacity='1'; }, 50);
      i++;
      setTimeout(reveal, 160);
    }
    reveal();
  }, 120);
}

/* ============================
   حفظ الرسائل في دفتر الحب
   ============================ */
saveBtn.addEventListener('click', ()=> {
  const txt = messageBox.textContent.trim();
  if(!txt) return;
  const time = new Date().toLocaleString('ar-EG', {hour:'2-digit', minute:'2-digit', day:'2-digit', month:'short', year:'numeric'});
  const entry = document.createElement('div');
  entry.style.padding = '10px';
  entry.style.borderBottom = '1px dashed rgba(163,58,90,0.06)';
  entry.innerHTML = `<div style="font-size:13px;color:var(--muted);margin-bottom:6px;">${time}</div><div style="font-size:15px;color:var(--text);white-space:pre-line">${escapeHtml(txt)}</div>`;
  journal.prepend(entry);
});

/* another message */
anotherBtn.addEventListener('click', () => {
  // choose according to last choice; if choiceDiv visible then show it; else default to short
  if(choiceDiv.style.display === 'block') {
    // just pick short by default
    showRandomShortMessage();
  } else {
    showRandomShortMessage();
  }
});

/* helper escape (for safety in journal) */
function escapeHtml(unsafe) {
    return unsafe.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
}

/* ============================
   original UI bindings (kept same behavior)
   ============================ */

yesBtn.addEventListener('click', () => {
  buttonsDiv.style.display = 'none';
  choiceDiv.style.display = 'block';
  messageBox.classList.remove('visible');
  messageBox.textContent = '';
  anotherBtn.style.display = 'none';
  saveBtn.style.display = 'none';
});

waitBtn.addEventListener('click', () => {
  buttonsDiv.style.display = 'none';
  messageBox.classList.remove('visible');
  messageBox.textContent = '';
  anotherBtn.style.display = 'none';
  saveBtn.style.display = 'none';
  showRandomWaitMessage();
});

shortMsgBtn.addEventListener('click', () => {
  choiceDiv.style.display = 'none';
  showRandomShortMessage();
  anotherBtn.style.display = 'inline-block';
  saveBtn.style.display = 'inline-block';
});

longMsgBtn.addEventListener('click', () => {
  choiceDiv.style.display = 'none';
  showRandomLongMessage();
  anotherBtn.style.display = 'inline-block';
  saveBtn.style.display = 'inline-block';
});

/* accessibility: Escape closes overlay as exit */
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape'){
    if(overlay && overlay.style.display !== 'none'){
      closeOverlayAndReveal(true);
      overlay.style.display = 'none';
    }
  }
});
dobInput.addEventListener('keydown', (e) => {
  if(e.key === 'Enter'){ e.preventDefault(); checkDobBtn.click(); }
});

/* small UI polish */
overlay.addEventListener('click', (e)=> {
  if(e.target === overlay){
    const modal = overlay.querySelector('.modal');
    modal.style.transition = 'transform 160ms ease';
    modal.style.transform = 'translateY(-6px)';
    setTimeout(()=> { modal.style.transform = 'translateY(0)'; }, 160);
  }
});

/* initial state: hide controls if overlay present (overlay shows by default) */
/* END OF SCRIPT */
</script>
</body>
</html>
